<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Kubedock :: Creating and Customizing Workspaces in Red Hat OpenShift DevSpaces</title>
    <link rel="prev" href="custom.html">
    <link rel="next" href="ides.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">Creating and Customizing Workspaces in Red Hat OpenShift DevSpaces</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/devspaces-workspaces/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header><div class="body">
<div class="nav-container" data-component="devspaces-workspaces" data-version="3">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Creating and Customizing Workspaces in Red Hat OpenShift DevSpaces</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">Workspaces</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="create.html">Creating Workspaces</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="udi.html">Universal Developer Image</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dashboard.html">Dev Spaces Dashboard</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="custom.html">Samples Dashboard</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="kubedock.html">Kubedock</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ides.html">Multiple IDEs in Dev Spaces</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../devfiles/index.html">Devfiles</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../devfiles/create.html">Creating a Devfile</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../devfiles/registry.html">Devfile Registry</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Creating and Customizing Workspaces in Red Hat OpenShift DevSpaces</span>
    <span class="version">3</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">Creating and Customizing Workspaces in Red Hat OpenShift DevSpaces</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">3</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Creating and Customizing Workspaces in Red Hat OpenShift DevSpaces</a></li>
    <li><a href="index.html">Workspaces</a></li>
    <li><a href="kubedock.html">Kubedock</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Kubedock</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><strong>Kubedock</strong> is a tool that allows developers to run containers inside OpenShift clusters as if they were running locally on a workstation. It bridges the gap between local container based development workflows and cloud-native environments, helping to replicate the local developer experience inside an OpenShift cluster.</p>
</div>
<div class="paragraph">
<p>This is particularly useful in development environments like Dev Spaces, which is designed for cloud-native, OpenShift based development.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Kubedock is meant as a temporary stop-gap fix to run "containers inside containers". OpenShift 4.17+ will allow this functionality to work natively without the need for Kubedock.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_kubedock_works"><a class="anchor" href="#_how_kubedock_works"></a>How Kubedock Works</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Kubedock intercepts linux container API calls made by developers or development tools and translates these into OpenShift-native constructs (such as Pods, Deployments, etc.).
When a developer issues a <code>podman run</code> command, instead of using the local Podman engine, Kubedock converts these commands to OpenShift resources, allowing the containers to run in the OpenShift cluster.</p>
</div>
<div class="paragraph">
<p>Kubedock manages the lifecycle of these resources, making the OpenShift environment behave more like a local Podman instance from the developer’s perspective.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/kubedock-diagram.svg" alt="kubedock diagram">
</div>
<div class="title">Figure 1. Kubedock</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_key_features_of_kubedock"><a class="anchor" href="#_key_features_of_kubedock"></a>Key Features of Kubedock:</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><strong>Podman Workflow:</strong> Developers can use familiar Podman commands (podman run, podman build, etc.) while developing in an OpenShift environment, maintaining their existing workflows. Instead of learning OpenShift-specific tools and syntax, they can continue using Podman commands that are familiar to them.</p>
</li>
<li>
<p><strong>OpenShift Integration:</strong> Kubedock ensures that containers run inside the OpenShift cluster, integrating seamlessly with other OpenShift services like networking, storage, and scaling, providing cloud-native capabilities. Developers get the benefits of OpenShift (scalability, orchestration, etc.) while retaining the simplicity of Podman commands. This provides a hybrid development experience that leverages the strengths of both Podman and OpenShift.</p>
</li>
<li>
<p><strong>Devfile Compatibility:</strong> It works with Devfiles (which Dev Spaces uses to define development environments) to enable the use of container images or commands as part of the developer’s workspace, while all underlying infrastructure runs in OpenShift.</p>
</li>
<li>
<p><strong>Consistency in Development and Production:</strong> Since Kubedock runs containers inside OpenShift, the development environment more closely mirrors production environments (which are often OpenShift-based). This reduces the risk of discrepancies between local development and production behavior, improving deployment reliability.</p>
</li>
<li>
<p><strong>No Need for a Local Podman Daemon:</strong> In cloud-native or distributed environments (like Eclipse Che), developers may not have access to a local Podman daemon. Kubedock eliminates the need for a local Podman installation by running containers directly in OpenShift, removing platform-specific limitations.</p>
</li>
<li>
<p><strong>Support for Complex Development Environments:</strong> Kubedock enables the use of complex containerized environments directly in OpenShift, supporting multi-container applications, microservices, or multi-tiered setups that are easier to orchestrate in a OpenShift cluster than with standalone Podman.</p>
</li>
<li>
<p><strong>Reduced Local Setup Complexity:</strong> Developers using Eclipse Che in combination with Kubedock don’t need to install Podman or manage local container runtimes. Everything is managed by OpenShift, reducing the overhead of local environment setup and configuration.</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The container image you want to use with Kubedock must be compliant with the <a href="https://docs.openshift.com/container-platform/4.16/openshift_images/create-images.html#images-create-guide-openshift_create-images" target="_blank" rel="noopener">Openshift Container Platform guidelines</a>. Otherwise, running the image with Kubedock will result in a failure even if the same image runs locally without issues.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>podman build -t &lt;image&gt; &amp;&amp; podman run &lt;image&gt;</code> command will fail. Instead, use <code>podman build -t &lt;image&gt; &amp;&amp; podman push &lt;image&gt; &amp;&amp; podman run &lt;image&gt;</code> by first building the image, pushing to a container registry, and then running it.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_references"><a class="anchor" href="#_references"></a>References</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.redhat.com/en/documentation/red_hat_openshift_dev_spaces/3.16/html-single/user_guide/index#running-containers-with-kubedock" target="_blank" rel="noopener">Kubedock</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_enabling_kubedock_and_working_with_containers_in_workspaces"><a class="anchor" href="#_lab_enabling_kubedock_and_working_with_containers_in_workspaces"></a>Lab: Enabling Kubedock and Working with Containers in Workspaces</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Inspect the repository at <a href="https://github.com/rsriniva/kubedock-test" class="bare">https://github.com/rsriniva/kubedock-test</a>. Review the simple devfile at <a href="https://github.com/rsriniva/kubedock-test/blob/main/devfile.yaml" class="bare">https://github.com/rsriniva/kubedock-test/blob/main/devfile.yaml</a></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">schemaVersion: 2.2.0
metadata:
  name: kubedock-test
components:
  - name: tools
    container:
      image: quay.io/devfile/universal-developer-image:latest
      memoryLimit: 3Gi
      <strong>env:
        - name: KUBEDOCK_ENABLED
          value: "true"
        - name: DOCKER_HOST
          value: 'tcp://127.0.0.1:2475'
      endpoints:
        - exposure: none
          name: kubedock
          protocol: tcp
          targetPort: 2475</strong></code></pre>
</div>
</div>
<div class="paragraph">
<p>You need to two environment variables to the devfile (<code>KUBEDOCK_ENABLED</code> and <code>DOCKER_HOST</code>). The first enabled Kubedock in the workspace, and the second indicates that the local daemon should be used for container builds. You also need to add an <code>endpoint</code> section and declare the port at which the Kubedock daemon should listen.</p>
</div>
</li>
<li>
<p>Fork this repository into your own GitHub account.</p>
</li>
<li>
<p>Log in to Dev Spaces as <code>user`</code>. Launch a new workspace using the Git URL <a href="https://github.com/&lt;your_github_user&gt;/kubedock-test" class="bare">https://github.com/&lt;your_github_user&gt;/kubedock-test</a>.</p>
</li>
<li>
<p>Once the workspace is fully loaded, open a new terminal window and verify that Podman is working correctly</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ podman info
<em>host:
  arch: amd64
  buildahVersion: 1.33.8
...
version:
  APIVersion: 4.9.4-rhel
...
  Os: linux
  OsArch: linux/amd64
  Version: 4.9.4-rhel</em></code></pre>
</div>
</div>
</li>
<li>
<p>Run a simple container using <code>podman run</code></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ podman run docker.io/hello-world
<em>Hello from Docker!
This message shows that your installation appears to be working correctly.
...</em></code></pre>
</div>
</div>
</li>
<li>
<p>The repository contains a simple Dockerfile that builds a container image using a statically compiled C program (<code>hello</code>). Build the container image.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ podman build -t hello .
<em>STEP 1/3: FROM scratch
STEP 2/3: COPY hello /
--&gt; a6da5afc829b
STEP 3/3: CMD ["/hello"]
COMMIT hello
--&gt; 443fe4de6c5e
Successfully tagged localhost/hello:latest
...</em></code></pre>
</div>
</div>
</li>
<li>
<p>Verify that the image is built successfully</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ podman images
<em>REPOSITORY       TAG         IMAGE ID      CREATED             SIZE
localhost/hello  latest      443fe4de6c5e  About a minute ago  16.5 kB</em></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you try to run this locally built container image, it will fail. You need to tag and push this image to an external container registry and then run it.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="custom.html">Samples Dashboard</a></span>
  <span class="next"><a href="ides.html">Multiple IDEs in Dev Spaces</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
