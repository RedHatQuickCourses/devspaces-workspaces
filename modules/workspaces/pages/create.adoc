= Creating Workspaces

You can create a Workspace using different ways:

* *Devfile*: You can create a workspace by providing a devfile, which is a YAML configuration that defines the workspace environment.
* *Dashboard Template*: Red Hat OpenShift Dev Spaces offers pre-configured workspace templates for common development stacks. You can launch these from the Dev Spaces dashboard page.
* *Git repository*: You can create a workspace directly from an existing Git repository.

*Devfiles* are covered in detail in a separate chapter. This is the most common and flexible approach, allowing you to customize the Workspace environment to suit your needs.

This chapter will cover launching Workspaces using Git repositories and the Dashboard Templates.

== Creating a Workspace using a Git Repository

You can use a Git repository URL in your browser to launch a new workspace that contains a clone of a Git repository. This way, you can clone a Git repository that is hosted on GitHub, GitLab, Bitbucket or Microsoft Azure DevOps server instances.

A number of useful starter examples for various programming language runtimes and frameworks is available at https://github.com/orgs/devspaces-samples/repositories.

> TODO: Add different URL params and show how workspaces can be created by passing different URL params

== Lab: Create a Workspace using a Git Repository

=== Pre-requisites

You must have installed and configured a Dev Spaces instance in the second course in the learning path (https://redhatquickcourses.github.io/devspaces-admin[Red Hat OpenShift Dev Spaces Administration^]). Both the `admin` and `user1...user5` users must be allowed to log in using the password `openshift23`.

=== Steps

. Log in to Dev Spaces as the `user1` user. 

. Inspect the GitHub repository at https://github.com/che-samples/web-nodejs-sample. This repository contains the source code for a simple Node.js web application. You will create a workspace and clone this repository in the next steps. Inspect and review the `devfile.yaml`, which is the Devfile for this application, and it is always stored at the root of the Git repository
+
NOTE: You can also import a Git repository without a `devfile.yaml`. In such a case, Dev Spaces will use Red Hat's __Universal Developer Image (UDI)__ as the base image, if a base container image is not provided in the `devfile.yaml`. UDI is a large container image containing the development tools and runtimes for a number of popular programming languages. You will learn about UDI in a separate section in the `Devfiles` chapter.

. Fork this repository to your GitHub account.

. In the Dev Spaces Dashboard page, enter `https://github.com/<your_github_userid>/web-nodejs-sample` in the `Git Repo URL` field in the `Import from Git` section, and click `Create & Open`
+
image::launch-git-repo.png[title=Launch a Workspace from Git]

. You will be prompted to trust the authors of this Git repository. Click `Continue`.

. Wait for a few minutes while the large UDI image is downloaded and the workspace is created
+
image::ws-creation.png[title=Workspace creation in progress]

. After a while, the workspace should load with the VSCode web IDE, with the source code from the Git repository cloned in the workspace.
+
image::ws-open.png[title=Workspace with source code]

. You can now work with this project just like you would use VSCode installed on your local workstation. You can open a terminal and run commands like `npm install, npm test, npm start etc`. However, the `devfile.yaml` has provided some convenient commands listed under the `commands` section.

. Inspect the `devfile.yaml` in the Workspace. Note the commands under the `commands` attribute. These commands are available as VSCode `Tasks` in the editor menus. Expands the menu to the left of the `EXPLORER` (three vertical bars), and click `Terminal > Run Task`
+
image::task-menu.png[title=VSCode Task Menu]

. You will be shown a list of tasks supplied by the devfile. Click `Show all Tasks` to see the full task list
+
image::all-tasks.png[title=All Tasks]

. Run the `devfile:Install dependencies` task, which runs `npm install` and fetches all the dependencies for the project.

. Next, run the `devfile: Run web application` task. A pop in the right bottom corner informs you that the application is running and listening on port `3000` and that the web application is available for preview. Click `Open in New Tab`, and then click `Open` in the following prompt. You should see `Hello World` printed as output.

. Press `Ctrl-C` to terminate the application in the terminal window at the bottom. 

== Optional Lab Steps

. Make some changes to the application source code at `app/app.js`. Change the welcome message. Re-run the application and verify that your changes are reflected.
. If you have configured GitHub authentication as per set up in the second course, your GitHub ID will be used in your workspace to track source changes. Run `git status` to see the changes you made and then run `git add` and `git commit`, followed by `git push` to push your changes back to your forked repository. Your Git workflow must work similar to your local workstation. You can also view changes and work with Git using the Git menu in VSCode in the left sidebar:
+
image::git-menu.png[title=Git menu in VSCode]
. Since the workspace uses the UDI base image, OpenShift client tools should be available. Run `oc whoami` and verify that `user1` is displayed. The OpenShift authentication tokens are automatically injected into the workspace. You can directly deploy the application to OpenShift and manage it from within the workspace.
+
image::oc-tools.png[title=OpenShift client tool]